---
title: "Penguin trait variation in the Palmer Archipelago"
author: "Cindy Gao"
date: "2025-09-29"
bibliography: references.bib
csl: "https://raw.githubusercontent.com/citation-style-language/styles/master/ecology-letters.csl"
output:
  pdf_document:
    fig_caption: yes
    extra_dependencies: ["float"]
---

<!-- setting up global options - making it so that figures don't float -->

```{r global_options, include = FALSE, echo = FALSE, warning =FALSE}
knitr::opts_chunk$set(fig.pos = "H", out.extra = "")
```

<!-- loading packages and reading in data -->

```{r setup, include = FALSE, echo = FALSE}
library(tidyverse)
library(ggplot2)
library(renv)
library(readr)

penguin_data <- read_csv("../02_outdata/CG_LDP_cleanedpenguins_1.csv")
```

# Introduction

Species' trait variation can give crucial insights into both the responses of species' to environmental gradients and the strength of filtering by those same gradients[@fitzgerald2025]. For example, strong environmental filtering may cause a specific set of trait values to be best suited to a system, decreasing overall trait variation with knock-on effects for overall community diversity [@craven2018]. Constrained trait values may also indicate low plasticity, developmental limits, or certain trait tradeoffs, which may also have negative implications for overall biodiversity [@arnold1992]. Consequently, identifying areas where species' trait variation is low or high may be of relevance to determining where species may be most threatened.

# Methods

The study used the Palmer Penguins dataset , which has physical measurements for adult penguins observed on Biscoe, Dream, and Torgersen Island [@horst2020]. The study sought to answer two questions related to spatial variation in penguin traits: 1) Do mean penguin trait values vary across Biscoe, Dream, and Torgersen Island, and 2) Do relationships between trait differ across Biscoe, Dream, and Torgersen Island?

The traits used in the study included flipper length (mm), bill length (mm), and body mass (g). Question 1 was answered using ANOVAs that tested for differences in mean trait values across islands. Pairwise comparisons were performed using a post-hoc Tukey test.

Question 2 was answered using a linear regression model that included an interaction term of the island. Pairwise comparisons were performed using a post-hoc Tukey test.

# Figures

<!-- Creating boxplots of flipper length for each island. -->

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.cap= "Boxplots of flipper length (mm) across islands. Biscoe Island had the widest distribution and was significantly different from Dream and Torgersen Islands."}
ggplot(penguin_data, aes(x = island, y = flipper_length_mm)) +
  geom_boxplot() +
  labs(x = 'Island', y = 'Flipper Length (mm)', title = 'Distribution of flipper length (mm) across islands') +
  theme_classic()
```
<!-- Using ggplot2 to calculate linear regressions for bill length and flipper length for each island. -->
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "Comparison of the relationship between flipper and bill length across Biscoe, Dream, and Torgersen Island. Bill and flipper measurements were grouped by island and each group was fitted with a separate linear regression line. The relationship between traits on Biscoe Island is significantly different from Dream and Torgersen Island, whereas the relationship between traits is not significantly different between Dream and Torgersen Island."}
ggplot(penguin_data, aes(x = bill_length_mm, y = flipper_length_mm, color = island)) +
  geom_point(size = 3, alpha = 0.5) +
  geom_smooth(method = "lm", se = F) +  
  labs(
    title = "Flipper length-Bill length relationship across Biscoe, Dream,\n and Torgersen Islands",
    x = "Bill Length (mm)",
    y = "Flipper Length (mm)",
    color = "Island"
  ) +
  theme_classic()
```

# Tables

<!-- I am first using tidyr to group the penguin data by island. I then calculate the mean
bill length, flipper length, and body mass for each island. These calculated values are then
assembled as a table. -->

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "A table summarizing mean trait values across the islands. Biscoe Island has the largest average trait values, followed by Dream Island, and then Torgersen Island."}
penguin_summary <- penguin_data |>
  group_by(island) |>
  summarise(
    count = n(),
    `Mean Bill Length (mm)` = mean(bill_length_mm, na.rm = T),
    `Mean Flipper Length (mm)` = mean(flipper_length_mm, na.rm = T),
    `Mean Body Mass (g)` = mean(body_mass_g, na.rm = T)
  )


knitr::kable(penguin_summary,
             caption = "Mean trait measurements across sites.")
```

# References
